<body>
  <script type="importmap">
    {
      "imports": {
        "three": "../../../node_modules/three/build/three.module.js",
        "three/examples/": "../../../node_modules/three/examples/",

        "@monogrid/gainmap-js/encode": "../../../dist/encode.js"
      }
    }
  </script>
  <script type="module">
    import { findTextureMinMax } from '@monogrid/gainmap-js/encode';
    import { EXRLoader } from 'three/examples/jsm/loaders/EXRLoader.js'
    import { RGBELoader } from 'three/examples/jsm/loaders/RGBELoader.js'

    window.findTextureMinMax = async (url) => {
      let loader
      if (url.indexOf('.exr') !== -1) loader = new EXRLoader()
      if (url.indexOf('.hdr') !== -1) loader = new RGBELoader()
      const image = await loader.loadAsync(`https://local/${url}`)

      return {
        max: findTextureMinMax(image),
        min: findTextureMinMax(image, 'min')
      }
    }

  </script>
</body>
