<body>
  <script type="importmap">
    {
      "imports": {
        "three": "../../../node_modules/three/build/three.module.js",

        "@monogrid/gainmap-js/encode": "../../../dist/encode.js",
        "@monogrid/gainmap-js": "../../../dist/decode.js"
      }
    }
  </script>
  <script type="module">
    import { WebGLRenderer } from 'three';
    import { JPEGRLoader } from '@monogrid/gainmap-js';
    import { findTextureMinMax } from '@monogrid/gainmap-js/encode';

    window.JPEGRLoader = async (url) => {
      const loader = new JPEGRLoader(new WebGLRenderer())
      const result = await loader.loadAsync(`https://local/${url}`)
      return {
        width: result.width,
        height: result.height,
        data: Array.from(result.toArray()),
        max: findTextureMinMax(result.toDataTexture())
      }
    }

  </script>
</body>
